set shell := ["bash", "-lc"]
set dotenv-load := true

backend:
	uv run uvicorn app:app --reload

frontend:
	uv run streamlit run streamlit_app.py

chat:
	uv run chainlit run explore/chatlit_app.py -w --port 8001

mcp:
	npx -y mcp-picnic

dev mode="normal":
	#!/usr/bin/env bash
	trap 'kill $(jobs -p)' INT TERM EXIT
	npx -y mcp-picnic &
	uv run uvicorn app:app --reload &
	if [ "{{ mode }}" = "chat" ]; then
		uv run chainlit run explore/chatlit_app.py -w --port 8001 &
	else
		uv run streamlit run streamlit_app.py &
	fi
	wait
